This is the version 2 of my code.